@import "../../vars.styl";
@import "../../queries.styl";

storyItemWidth(elementCount)
	// ( (Full width - scrollbor - story-list-padding) / elementCount ) - element-padding
	// scrollbar = 17px
	// story-list-padding = 2x6px = 12px
	// element-padding = 2x4px = 8px
	"calc( ( (100vw - 29px) / %s) - 10px)" % elementCount

storyItemHeight(elementCount)
	"calc( ( ( ( (100vw - 29px) / %s) - 8px) / 3 ) - 11px )" % elementCount

// same as above but it adds 22px for the progress bar height + progress bar top
storyItemHeightWithProgress(elementCount)
	"calc( ( ( ( (100vw - 29px) / %s) - 8px) / 3 ) + 22px)" % elementCount


.story-browser-layout
	display: flex
	flex-direction: column
	overflow: hidden
	@media mobile
		overflow: initial
	*
		box-sizing:border-box;
	nav
		margin-top: 20px;
		background: $$bgDark;
		width: 100%;
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: center;

@media screen and (min-width: 800px) and (min-height: headerCutoff)
	.story-browser-layout
		.story-list
			top: 0px;

@media screen and (max-width: 800px) and (min-height: headerCutoff)
	.story-browser-layout
		.story-list
			top: 10px;

.story-list-wrapper
	overflow: auto
	width: 100vw /* IE 11.0.155 needs us to be explicit about this to make flex-flow: row wrap work */
	height: calc(100% + 10px) /* prevents scrolling when have just one story item*/
	display: flex
	align-items: flex-start
	flex-direction: column
	@media mobile
		overflow: initial
.story-browser-navigation
	display: flex
	//flex-direction: column
	justify-content: space-between
	align-items: center
	padding: 5px 10px 0 10px
	width: 100%
	@media mobileLandscape
		padding: 0px 15px
		margin-bottom: 10px
	&--with-select
		min-height: 40px
		margin: 10px 0px
	.breadcrumbs-set
		width: 100%
		min-height: 28px
		flex-grow: 1
.story-browser-navigation {
  .breadcrumbs-arrow {
    line-height: 24px;
    .material-icons {
      line-height: 26px;
    }
  }
}
.story-list
	width:100%;
	// MT-2373 maxWidth needed for IE language switch bug
	max-width: 100vw
	display: flex;
	flex-flow: row wrap;
	position: relative;
	justify-content: flex-start;
	flex: 0 0 auto;
	background: $$bgMedium;
	padding: 24px 4px;
	@media mobileLandscape
		padding: 0px 10px;
	.image-container
		overflow: hidden;
		height: 100%;
		width: 100%;
		display: flex;
		justify-content: center;
		align-items: center;

	&.focus
		.story-thumbnail
			display:block;
			width:100%;
			height:100vw;
			border:none;

		.story-item
			background: #f7ecda;
			padding-bottom:50px;

		.story-info
			display:block;
			width:100%;
			height:auto;
			padding:20px 20px 50px 20px;
			font-size:80%;
			background:#ffffff;
			box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
						0 3px 1px -2px rgba(0, 0, 0, 0.2);
			.languages
				display:block;
				font-size:120%;

	.story-info
		.languages
			display:none;
			em
				color:#000000;
				font-style:normal;

	.image-wrapper
		background: white;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		position: relative;
		overflow: hidden;
		vertical-align: middle;

.story-item
	display:flex;
	cursor:pointer;
	overflow:hidden;
	background: white;
	flex-direction: row;
	margin: 5px;
	width: 100%;
	height: storyItemHeight(1)
	box-shadow: 0 1px 10px 0 rgba(0, 0, 0, 0.15);
	.story-thumbnail
		line-height:0;
		padding:0;
		background:transparent no-repeat center center;
		background-size:cover;
		width: storyItemHeight(1)
		flex-shrink: 0
	&--with-progress
		height: storyItemHeightWithProgress(1)
		.story-info .finder-icon
			position: initial
		.story-thumbnail
			width: storyItemHeightWithProgress(1)
	&:before {
		content: "";
		display: block;
		padding-top: 100%;
	}

.story-info-wrapper
	display: flex
	flex: 2;
	flex-direction: column;
	position: relative;
	justify-content: flex-start
	.progress-bar
		position: absolute
		margin-left: 20px
		margin-top: 20px
		left: 0;
		top: 0;


.story-info
	flex: 2;
	padding: (1px * storyInfoVerticalPadding) 10px  (1px * storyInfoVerticalPadding) 20px;
	text-wrap: balance; /* for when this additional value to the existing text-wrap property of CSS becomes supported */
	font-size:75%;
	box-sizing:border-box;
	display:flex;
	align-items: center
	position: relative;
	height: 100%
	overflow: hidden
	&--fake-info
		visibility: hidden;
		position: relative;
		display: block;
		top: -100000px;
		left: -100000px;
		.title
			overflow: visible
			display: inline

	.finder-icon
		color: rgba(0, 0, 0, 0.20);
		font-size: 1.3em;
		top: 5%;

	.title-wrapper
		display: flex;
		flex-flow: row nowrap;
		align-content: center;
		align-items: center;

		.inline-play-button
			margin-right: 5px;

		.title
			margin:0;
			font-size: 18pt;
			font-weight: normal;
			color:#000000;
			width:100%;
			overflow:hidden;
			text-overflow:ellipsis;
			max-height: 100%
			word-break: break-word

			&.hide-search-hit .search-hit
				background-color: transparent;

			&.smooth-resize
				transition: font-size 0.5s;

	.rating
		margin:5px 0;
		.fa
		.svg-inline--fa
			padding-right: 3px;
	&:after
		content: ""
		position: absolute
		z-index: 1
		bottom: 0
		left: 0
		pointer-events: none
		background-image: linear-gradient(to bottom, rgba(255,255,255, 0), rgba(255,255,255, 1))
		width: 100%
		height: 40px

@media only screen and (min-width: 30em)
	.story-item
		width: storyItemWidth(2)
		height: storyItemHeight(2)
		.story-thumbnail
			width: storyItemHeight(2)
		&--with-progress
			height: storyItemHeightWithProgress(2)
			.story-thumbnail
				width: storyItemHeightWithProgress(2)
	.scopeTitle
		width: storyItemWidth(2)
	.story-list.list.full-render
		.story-item
			width: storyItemWidth(1)
			height: storyItemHeight(1)
			.story-thumbnail
				width: storyItemHeight(1)
			&--with-progress
				height: storyItemHeightWithProgress(1)
				.story-thumbnail
					width: storyItemHeightWithProgress(1)
		.scopeTitle
			width: storyItemWidth(1)

	.story-browser-layout nav:before,.story-browser-layout nav:after
		display:table;
		content:""


	.story-browser-layout nav:after
		clear:both

	.story-list.focus
		background: #f7ecda;


	.story-list.focus .story-item
		float:none;
		background:#ffffff;
		width:100%;
		padding-bottom:0;
		margin-bottom:50px;
		box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
					0 3px 1px -2px rgba(0, 0, 0, 0.2);


	.story-list.focus .story-thumbnail
		display:inline-block;
		width:50%;
		height:50vw;
		max-width:400px;
		max-height:400px;


	.story-list.focus .story-info
		display:inline-block;
		width:50%;
		box-shadow:none;

@media only screen and (min-width: 48em)
	.story-list.list.full-render
		.story-item
			width: storyItemWidth(1)
			height: storyItemHeight(2)
			.story-thumbnail
				width: storyItemHeight(2)
			&--with-progress
				height: storyItemHeightWithProgress(2)
				.story-thumbnail
					width: storyItemHeightWithProgress(2)

@media only screen and (min-width: 64em)
	.story-item
		width: storyItemWidth(3)
		height: storyItemHeight(3)
		.story-thumbnail
			width: storyItemHeight(3)
		&--with-progress
			height: storyItemHeightWithProgress(3)
			.story-thumbnail
				width: storyItemHeightWithProgress(3)

	.story-list.list.full-render
		.story-item
			width: storyItemWidth(1)
			height: storyItemHeight(3)
			.story-thumbnail
				width: storyItemHeight(3)
			&--with-progress
				height: storyItemHeightWithProgress(3)
				.story-thumbnail
					width: storyItemHeightWithProgress(3)

	.story-list.list.half-render
		.story-item
			width: storyItemWidth(2)
			height: storyItemHeight(4)
			.story-thumbnail
				width: storyItemHeight(4)
			&--with-progress
				height: storyItemHeightWithProgress(4)
				.story-thumbnail
					width: storyItemHeightWithProgress(4)

@media only screen and (min-width: 87em)
	.story-item
		width: storyItemWidth(4)
		height: storyItemHeight(4)
		.story-thumbnail
			width: storyItemHeight(4)
		&--with-progress
			height: storyItemHeightWithProgress(4)
			.story-thumbnail
				width: storyItemHeightWithProgress(4)

.story-browser-languageSwitcher
	margin-right: 18px
	margin-left: auto
	z-index: 10
	@media mobile
		margin-right: 0px
	.Select
		.Select-control
			.Select-value
				text-align: center
				line-height: 46px
	// 		.Select-placeholder
	// 			margin-left: -10px
				// text-align: center
	.languageOptions
		z-index: 1
		float: right
		position:relative
		min-height: 25px
		display: flex
		align-items: center
		.circlebutton
			width: 35px
			height: 35px
			&-inner
				&-mainvalue
					top: 0.1rem
				&-subvalue
					top: 1.1rem
	&-select
		position:relative
		width: 260px
		min-width: 175px
		z-index: 1
		float: right
		& > div
			padding: 0
		@media mobile
			max-width: 120px
			min-width: 100px
			font-size: 12px
	&:after
		content: ""
		display: block
		clear: both

.h-full
	height: 100%
